<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name=viewport content="width=device-width, initial-scale=1"><title>Knopa: file manager</title><style>body{margin:0;font-family:Sans-serif;font-size:15px}#page{margin:auto;width:800px;max-width:100%}h1{font-family:Tahoma,Verdana;font-size:2.1em;padding:.1em 0 .1em .5em;margin:0 0 .2em;color:#FFF;font-weight:bold;text-shadow:-1px 0 0 #666,0px -1px 0 #666,1px 0 0 #666,0px 1px 0 #666,-1px -1px 0 #222,-1px 1px 0 #222,1px -1px 0 #222,1px 1px 0 #222;background:#6cc;background:linear-gradient(to right,rgba(96,193,193,1) 0,rgba(96,193,193,1) 50%,rgba(234,255,255,1) 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#66cccc',endColorstr='#eaffff',GradientType=1)}table#files{width:99.8%;border-collapse:collapse;border-spacing:0;font-size:1em}table#files td{padding:.3em .5em;border:1px solid #AAA}.foo{font-weight:bold;padding:.3em .5em}table.foo td:last-child,table#files td:nth-child(2){text-align:right}.footer{text-align:center;position:fixed;bottom:5%;width:80%;left:50%;margin-left:-40%;background:rgba(55,55,55,0.5);border-radius:1em}#err{color:#653636}#msg{color:#FFF}#err,#msg{line-height:2em}input.val{width:2.5em}input.fname{font-size:1.1em;border:1px solid transparent;outline:0}</style><script type="text/javascript">/*<![CDATA[*/function $(a){return document.getElementById(a)}function $css(b,a){a=a||document;return a.querySelectorAll(b)}function $i(b,a){$(b).innerHTML=a}function ajaxReq2(d,f,b){var c="/files";if(!d){msg(say("cnn")+"...")}var e=new XMLHttpRequest();e.open(f,c+(f=="GET"?"?"+b[0]:""),true);e.onreadystatechange=function(){if(e.readyState==4&&b[1]){b[1](e,b[2])}};e.send(f=="GET"?null:b[0])}function ajaxGet(){ajaxReq2.call(this,0,"GET",arguments)}function ajaxPost(){ajaxReq2.call(this,1,"POST",arguments)}var nsTmpl=(function(){return{cache:{},tmpl:function(d,c){var a="var p=[];with(obj){p.push('"+d.replace(/[\r\t\n]/g," ").replace(/^\s+</g,"<").replace(/>\s+$/g,">").replace(/>\s+</g,"><").replace(/'(?=[^%]*%>)/g,"\t").split("'").join("\\'").split("\t").join("'").replace(/<%=(.+?)%>/g,"',$1,'").split("<%").join("');").split("%>").join("p.push('")+"');}return p.join('');";var b=!/\W/.test(d)?this.cache[d]=this.cache[d]||this.tmpl(document.getElementsByClassName(d)[0].innerHTML):new Function("obj",a);if(c){return b(c)}return c?b(c):b},tmplr:function(d,c){var b="";for(var a=0;a<(c?c.length:0);a++){b+=this.tmpl(d,c[a])}return b}}})();Date.prototype.format=function(fmt,magic){with(this){if(!getTime()){return""}var d=getDate(),m=getMonth()+1,y=getFullYear(),h=getHours(),n=getMinutes(),s=getSeconds()}fmt=fmt.replace(/dd/,d<=9?"0"+d:d).replace(/mm/,m<=9?"0"+m:m).replace(/d/,d).replace(/m/,m).replace(/yyyy/,y).replace(/yy/,y%100).replace(/hh/,h<=9?"0"+h:h).replace(/h/,h).replace(/nn/,n<=9?"0"+n:n).replace(/([^Ja|Ju])n/,"$1"+n).replace(/ss/,s<=9?"0"+s:s).replace(/s/,s);return fmt};function msg(a,c,b){$i("err",c||"");$i("msg",a||"");if(!b){if(c){setTimeout(function(){$i("err","")},3000)}if(a){setTimeout(function(){$i("msg","")},3000)}}}function pjson(req){if(!req){msg("",say("xcn"));return 0}try{var data=eval("("+req.responseText+")")}catch(e){msg("",say("xrf")+": "+req.responseText,1);return 0}return data}var cEnv={marks:["ttl","upl","nm","sz","dt","tot","use","dat","fre","rdy","ung","nof","del","cnn","xcn","xrf","fmt","sur","rn","rnh"],msgs:[["Knopa Files","Upload","Name","Size","Datetime","Total space","Used","Data","Free space","Ready","Uploading","No files","Delete","Connecting","Connection error","Response format error","Format","Are you sure?","Rename","Click file to rename..."],["Файлы","Загрузить","Имя","Размер","Дата/время","Всего места","Занято","Данные","Свободно","Готово","Загружаем","Нет файлов","Удалить","Ожидание ответа","Ошибка связи","Неверный формат ответа","Форматировать","Вы уверены?","Переименовать","Нажмите на файл..."]],lngs:["en","ru"],rename:0};function say(a){return cEnv.msgs[cEnv.lngs.indexOf(cEnv.lang)][cEnv.marks.indexOf(a)]}function init(){var a=window.location.href;cEnv.lang=a.replace(/.*?lang=(\w+).*/g,"$1");if(cEnv.lang==a){cEnv.lang="ru"}$i("page",nsTmpl.tmpl("tpage",{}));upd()}function upd(a){$("infile").value="";ajaxGet("ls=1",received,a)}function vnum(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,"&nbsp;")}function ctrls(a){$("upld").disabled=$("frmt").disabled=!a}function uploaded(b){var a=pjson(b);upd(a.result)}function received(c,b){var a=pjson(c);$i("total",vnum(a.total));$i("used",vnum(a.used));$i("data",vnum(a.data));$i("free",vnum(a.free));$i("files",a.files.length?nsTmpl.tmpl("hfile",{})+nsTmpl.tmplr("file",a.files):"<tr><td>"+say("nof")+"</td></tr>");ctrls(1);msg(b)}function upload(){var a=$("infile");if(!a.files.length){return}var b=new FormData();b.append("upload",a.files[0]);msg(say("ung")+"...","",true);ctrls(0);ajaxPost(b,uploaded)}function del(a){if(confirm(say("del")+" "+a+" ?")){ajaxGet("rm="+encodeURIComponent(a),received)}}function format(){if(confirm(say("sur"))){msg(say("cnn")+"...");ctrls(0);ajaxGet("fmt",received)}}function ren_send(c){var d=c.parentNode.parentNode;var b=$css("input",d)[0].value;var a=$css("a",d.nextSibling)[0].text;ajaxGet("rename="+encodeURIComponent(a)+"&into="+encodeURIComponent(b),ren_res,{tr:d,nfname:b})}function ren_res(d,b){var e=pjson(d);if(e.result=="ok"){var c=$css("a",b.tr.nextSibling)[0];c.text=b.nfname;c.href="/"+b.nfname;b.tr.nextSibling.style.display="";b.tr.parentNode.removeChild(b.tr);msg("","")}else{msg("",e.result)}}function ren_form(b){var c=$css("a",b)[0].text;var a=document.createElement("tr");a.className="tredit";a.innerHTML='<td colspan="3"><input class="fname" type="text" value="'+c+'" style="width:100%" onkeydown="ren_key(event,this)"></td><td style="width:1%"><input type="button" value="OK" onclick="ren_send(this)"></td>';b.parentNode.insertBefore(a,b);b.style.display="none";$css("input",a)[0].focus();return false}function ren_key(a,b){if(a.which==13||a.keyCode==13){ren_send(b);return false}return true}function rename(c){cEnv.rename^=1;var b,a=$css("tr.frow");if(cEnv.rename){$("rename-hint").innerHTML=say("rnh");for(b=0;b<a.length;b++){$css("a",a[b])[0].onclick=ren_form.bind(this,a[b])}}else{$("rename-hint").innerHTML="";for(b=0;b<a.length;b++){a[b].style.display="";$css("a",a[b])[0].onclick=null}a=$css("tr.tredit");for(b=0;b<a.length;b++){a[b].parentNode.removeChild(a[b])}}};/*]]>*/</script></head><body onload="init()"><div id="page"></div><div class="footer"><div id="err"></div><div id="msg"></div></div></body><script class="tpage" type="text/html"><h1><%=say('ttl')%></h1><div id="loader"><form id="form_upload" class="foo" method="post" enctype="multipart/form-data"><input id="infile" type="file" name="file"><input id="upld" type="button" value="<%=say('upl')%>" onclick="upload()"><br><br><input type="button" onclick="rename(this)" value="<%=say('rn')%>"/>&nbsp;<span id="rename-hint"></span></form><table id="files"></table><table class="foo"><tr><td><%=say('tot')%>:</td><td id="total"></td></tr><tr><td><%=say('use')%>:</td><td id="used"></td></tr><tr><td><%=say('dat')%>:</td><td id="data"></td></tr><tr><td><%=say('fre')%>:</td><td id="free"></td></tr></table><div class="foo" style="float:right">Dump sectors&nbsp;<input class="val" type="text" id="dfr" value="00">...<input class="val" type="text" id="dto" value="7F">&nbsp;<button type="submit" id="dump"onclick="window.open('?dump&fr='+parseInt($('dfr').value,16)+'&to='+parseInt($('dto').value,16))">OK</button></div><div class="foo"><input id="frmt" type="button" value="<%=say('fmt')%>" onclick="format()"/></div></script><script class="hfile" type="text/html"><tr class="file"><th><%=say('nm')%></th><th><%=say('sz')%></th><th><%=say('dt')%></th><th></th></tr></script> <script class="file" type="text/html"><tr class="file frow"><td><a href="/<%=encodeURI(name)%>"><%=name%></a></td><td><%=vnum(size)%></td><td><%=(new Date(dt*1000)).format("dd-mm-yyyy hh:nn:ss")%></td><td style="width:1%"><img onclick="del('<%=name%>')" src="data:image/gif;base64,R0lGODlhEAAQALMOAP8zAMopAJMAAP/M//+DIP8pAP86Av9MDP9sFP9zHv9aC/9gFf9+HJsAAP///wAAACH5BAEAAA4ALAAAAAAQABAAAARU0MlJKw3B4hrGyFP3hQNBjE5nooLJMF/3msIkJAmCeDpeU4LFQkFUCH8VwWHJRHIM0CiIMwBYryhS4XotZDuFLUAg6LLC1l/5imykgW+gU0K22C0RADs="></td></tr></script></html>